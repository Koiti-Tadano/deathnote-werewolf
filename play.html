<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>プレイ | デスノート人狼（非公式）</title>
<link rel="stylesheet" href="assets/css/style.css">

<!-- ✅ Firebase SDK 読み込み -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<!-- ✅ Firebase 設定（config.js 内でもOK） -->
<script>
  var firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "XXXXXXX",
    appId: "1:XXXXXXX:web:XXXXXXX"
  };
  firebase.initializeApp(firebaseConfig);
</script>
</head>
<body>

<div class="nav">
  <div class="nav-inner">
    <div class="brand"><div class="logo">DN</div><div class="title">デスノート人狼（非公式）</div></div>
    <details class="nav-accordion">
      <summary>メニュー</summary> 
      <div class="menu">
        <a class="button" href="index.html"><strong>トップ</strong></a>
        <a class="button" href="rules.html"><strong>ルール</strong></a>
        <a class="button" href="materials.html"><strong>配布物</strong></a>
        <a class="button" href="samples.html"><strong>サンプルプレイ</strong></a>
        <a class="button" href="play.html"><strong>プレイ</strong></a>
      </div>
    </details>
  </div>
</div>

<label>プレイヤー名: 
  <input type="text" id="playerNameInput" placeholder="名前を入力">
</label>
<br><br>

  
<!-- ルーム参加 -->
<h2>ルーム参加</h2>
<input type="text" id="joinRoomInput" placeholder="ルームIDを入力">
<button id="joinRoomBtn">参加</button>

<!-- ルーム作成 -->
<h2>ルーム作成</h2>
<button id="createRoomBtn">新しいルームを作る</button>
<p>あなたのルームID: <span id="roomIdDisplay"></span></p> 

<script>
  // ランダムなルームID生成
  function generateRoomId(length = 8) {
    const chars = "abcdefghijklmnopqrstuvwxyz0123456789";
    let id = "";
    for (let i = 0; i < length; i++) {
      id += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return id;
  }

// ルーム作成
document.getElementById("createRoomBtn").addEventListener("click", () => {
  const playerName = document.getElementById("playerNameInput").value.trim();
  if (!playerName) {
    alert("プレイヤー名を入力してください！");
    return;
  }

  localStorage.setItem("playerName", playerName);

  const newRoomId = generateRoomId();

  firebase.database().ref("rooms/" + newRoomId).set({
    createdAt: Date.now()
  });

  document.getElementById("roomIdDisplay").textContent = newRoomId;
  document.getElementById("copyRoomIdBtn").style.display = "inline-block";

  // 作った本人を自動でチャットに入れる
  window.location.href = `chat.html?room=${newRoomId}&name=${encodeURIComponent(playerName)}`;
});


// ルーム参加
document.getElementById("joinRoomBtn").addEventListener("click", () => {
  const playerName = document.getElementById("playerNameInput").value.trim();
  const roomId = document.getElementById("joinRoomInput").value.trim();

  if (!playerName || !roomId) {
    alert("名前とルームIDを入力してください！");
    return;
  }

  localStorage.setItem("playerName", playerName);

  window.location.href = `chat.html?room=${roomId}&name=${encodeURIComponent(playerName)}`;
});

// コピー機能
document.getElementById("copyRoomIdBtn").addEventListener("click", () => {
  const roomId = document.getElementById("roomIdDisplay").textContent;
  if (roomId) {
    navigator.clipboard.writeText(roomId).then(() => {
      alert("ルームIDをコピーしました: " + roomId);
    });
  }
});
</script>

</body>
</html>
